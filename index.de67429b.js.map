{"mappings":"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","sources":["src/core/view.ts","src/core/api.ts","src/config.ts","src/app.ts","src/store.ts","src/core/router.ts","src/page/news-feed-view.ts","src/page/news-detail-view.ts"],"sourcesContent":["export default abstract class View {\n  private template: string;\n  private renderTemplate: string;\n  private container: HTMLElement;\n  private htmlList: string[];\n\n  constructor(containerId: string, template: string) {\n    const containerElement = document.getElementById(containerId);\n\n    if (!containerElement) {\n      throw \"최상위 컨테이너가 없어 UI를 진행하지 못합니다.\";\n    }\n\n    this.container = containerElement;\n    this.template = template;\n    this.renderTemplate = template;\n    this.htmlList = [];\n  }\n\n  protected updateView(): void {\n    this.container.innerHTML = this.renderTemplate;\n    this.renderTemplate = this.template;\n  }\n\n  protected addHtml(htmlString: string): void {\n    this.htmlList.push(htmlString);\n  }\n\n  protected getHtml(): string {\n    const snapshot = this.htmlList.join(\"\");\n    this.clearHtmlList();\n\n    return snapshot;\n  }\n\n  protected setTemplatedata(key: string, value: string): void {\n    this.renderTemplate = this.renderTemplate.replace(`{{__${key}__}}`, value);\n  }\n\n  private clearHtmlList(): void {\n    this.htmlList = [];\n  }\n\n  abstract render(): void; // 추상 메서드\n}","import { NewsFeed, NewsDetail } from \"../types\";\nimport { NEWS_URL, CONTENT_URL } from \"../config\";\n\nexport class Api {\n  // Generic & protected\n  protected async request<AjaxResponse>(url: string): Promise<AjaxResponse> {\n    const response = await fetch(url);\n\n    // response.json 자체가 promise 객체를 return 하기 때문에 await을 붙여준다.\n    return await response.json() as AjaxResponse;\n  }\n}\n\nexport class NewsFeedApi {\n  async getData(): Promise<NewsFeed[]> {\n    return this.request<NewsFeed[]>(NEWS_URL);\n  }\n}\n\nexport class NewsDetailApi {\n  async getData(id: string): Promise<NewsDetail> {\n    return await this.request<NewsDetail>(CONTENT_URL.replace(\"@id\", id));\n  }\n}\n\nexport class Test {\n  protected printHello(): void {\n    console.log(\"Hello\");\n  }\n}\n\n// 기존의 extends라고 하는 방식의 상속 방법은 코드에 적시되어야 하는 상속 방법이다.\n// 상속의 관계를 바꾸고 싶으면 코드 자체를 바꿔야 한다는 의미이다. (관계를 유연하게 가져갈 수 없다.)\n\n// JS와 TS의 class extends 문법은 다중상속을 지원하지 않는다.\n// 상위 class n개를 받을수 있게 만들어보자 !\n// 아래 코드는 TS 공식 문서에서 제공하는 Mixin 관련 코드이며 Mixin을 구현하는 코드중 하나이다.\nfunction applyApiMixins(targetClass: any, baseClass: any[]): void {\n  baseClass.forEach((baseClass) => {\n    Object.getOwnPropertyNames(baseClass.prototype).forEach((name) => {\n      const descriptor = Object.getOwnPropertyDescriptor(baseClass.prototype, name);\n\n      if (descriptor) {\n        Object.defineProperty(targetClass.prototype, name, descriptor);\n      }\n    });\n  });\n}\n\n// TS 컴파일러에게 Api class를 내부적으론 합성한다는 사실을 알려주기 위해 interface를 작성한다.\nexport interface NewsFeedApi extends Api, Test {}\nexport interface NewsDetailApi extends Api {}\n\napplyApiMixins(NewsFeedApi, [Api, Test]);\napplyApiMixins(NewsDetailApi, [Api]);\n","export const NEWS_URL = \"https://api.hnpwa.com/v0/news/1.json\";\nexport const CONTENT_URL = \"https://api.hnpwa.com/v0/item/@id.json\";","import Router from \"./core/router\";\nimport Store from \"./store\";\nimport { NewsFeedView, NewsDetailView } from \"./page\";\n\nconst store = new Store();\n\nconst router: Router = new Router();\nconst newsFeedView = new NewsFeedView(\"root\", store);\nconst newsDetailView = new NewsDetailView(\"root\", store);\n\nrouter.setDefaultPage(newsFeedView);\nrouter.addRoutePath(\"/page/\", newsFeedView);\nrouter.addRoutePath(\"/show/\", newsDetailView);\n\nrouter.route();","import { NewsFeed, NewsStore } from \"./types\";\n\nexport default class Store implements NewsStore {\n  private feeds: NewsFeed[];\n  private _currentPage: number;\n\n  constructor() {\n    this.feeds = [];\n    this._currentPage = 1;\n  }\n\n  get currentPage() {\n    return this._currentPage;\n  }\n\n  set currentPage(page: number) {\n    this._currentPage = page;\n  }\n\n  get nextPage(): number {\n    return this._currentPage + 1;\n  }\n\n  get prevPage(): number {\n    return this._currentPage > 1 ? this._currentPage - 1 : 1;\n  }\n\n  get numberOfFeed(): number {\n    return this.feeds.length;\n  }\n\n  get hasFeeds(): boolean {\n    return this.feeds.length > 0;\n  }\n\n  getAllFeeds(): NewsFeed[] {\n    return this.feeds;\n  }\n\n  getFeed(position: number): NewsFeed {\n    return this.feeds[position];\n  }\n\n  setFeeds(feeds: NewsFeed[]): void {\n    this.feeds = feeds.map((feed) => ({\n      ...feed,\n      read: false,\n    }));\n  }\n\n  makeRead(id: number): void {\n    const feed = this.feeds.find((feed: NewsFeed) => feed.id === id);\n\n    if (feed) {\n      feed.read = true;\n    }\n  }\n}\n","import { RouteInfo } from \"../types\";\nimport View from \"./view\";\n\nexport default class Router {\n  private routeTable: RouteInfo[];\n  private defaultRoute: RouteInfo | null;\n\n  constructor() {\n    const routePath = location.hash;\n    const pathList = routePath.split(\"/\");\n\n    window.addEventListener(\"hashchange\", this.route.bind(this));\n\n    this.routeTable = [];\n    this.defaultRoute = null;\n  }\n\n  setDefaultPage(page: View): void {\n    this.defaultRoute = { path: \"\", page };\n  }\n\n  addRoutePath(path: string, page: View): void {\n    this.routeTable.push({ path, page });\n  }\n\n  route(): void {\n    const routePath = location.hash;\n\n    if (routePath === \"\" && this.defaultRoute) {\n      this.defaultRoute.page.render();\n    } else {\n      for (const routeInfo of this.routeTable) {\n        if (routePath.indexOf(routeInfo.path) >= 0) {\n          routeInfo.page.render();\n          break;\n        }\n      }\n    }\n  }\n}\n","import View from \"../core/view\";\nimport { NewsFeedApi } from \"../core/api\";\nimport { NewsFeed, NewsStore } from \"../types\";\n\nexport default class NewsFeedView extends View {\n  private api: NewsFeedApi;\n  private totalPages: number;\n  private pageSize: number;\n  private store: NewsStore;\n\n  constructor(containerId: string, store: NewsStore) {\n    let template = `\n    <div class=\"bg-gray-600 min-h-screen\">\n      <div class=\"bg-white text-xl\">\n        <div class=\"mx-auto px-4\">\n          <div class=\"flex justify-between items-center py-6\">\n            <div class=\"flex justify-start\">\n              <h1 class=\"font-extrabold\">Hacker News</h1>\n            </div>\n            <div class=\"item-center justify-end\">\n              {{__prev_page__}}\n              {{__next_page__}}\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"p-4 text-2xl text-gray-700\">\n        {{__news_feed__}}\n      </div>\n    </div>\n    `;\n\n    super(containerId, template);\n    this.api = new NewsFeedApi();\n    this.store = store;\n    this.totalPages = 1;\n    this.pageSize = 10;\n  }\n\n  async render() {\n    this.store.currentPage = Number(location.hash.substring(7)) || 1;\n\n    if (!this.store.hasFeeds) {\n      this.store.setFeeds(await this.api.getData());\n      this.totalPages =\n        Math.floor(this.store.numberOfFeed / this.pageSize) + (this.store.numberOfFeed % this.pageSize > 0 ? 1 : 0);\n    }\n\n    let page = this.store.currentPage - 1;\n\n    for (let i = page * this.pageSize; i < (page + 1) * this.pageSize; i++) {\n      const { id, title, comments_count, user, points, time_ago, read } = this.store.getFeed(i);\n      this.addHtml(`\n      <div class=\"p-6 ${\n        read ? \"bg-red\" : \"bg-white\"\n      } mt-6 rounded-lg shadow-md transition-colors duration-500 hover:bg-green-100\">\n      <div class=\"flex\">\n      <div class=\"flex-auto\">\n      <a href=\"#/show/${id}\">${title}</a>\n          </div>\n          <div class=\"text-center text-sm\">\n            <div class=\"w-10 text-white bg-green-300 rounded-lg px-0 py-2\">${comments_count}</div>\n          </div>\n        </div>\n        <div class=\"flex mt-3\">\n          <div class=\"grid grid-cols-3 text-sm text-gray-500\">\n            <div><i class=\"fas fa-user mr-1\"></i>${user}</div>\n            <div><i class=\"fas fa-heart mr-1\"></i>${points}</div>\n            <div><i class=\"fas fa-clock mr-1\"></i>${time_ago}</div>\n          </div>\n        </div>\n      </div>\n      `);\n    }\n\n    this.setTemplatedata(\"news_feed\", this.getHtml());\n    this.setTemplatedata(\n      \"prev_page\",\n      `<a href=\"#/page/${this.store.prevPage}\" class=\"${\n        this.store.currentPage > 1 ? \"text-gray-500\" : \"pointer-events-none text-gray-200\"\n      }\">Previous</a>`\n    );\n    this.setTemplatedata(\n      \"next_page\",\n      `<a href=\"#/page/${this.store.nextPage}\" class=\"ml-4 ${\n        this.store.currentPage < this.totalPages ? \"text-gray-500\" : \"pointer-events-none text-gray-200\"\n      }\">Next</a>`\n    );\n\n    this.updateView();\n  }\n}\n","import View from \"../core/view\";\nimport { NewsDetailApi } from \"../core/api\";\nimport { NewsComment, NewsDetail, NewsStore } from \"../types\";\n\nexport default class NewsDetailView extends View {\n  private api: NewsDetailApi;\n  private store: NewsStore;\n\n  constructor(containerId: string, store: NewsStore) {\n    let template = `\n    <div class=\"bg-gray-600 min-h-screen\">\n      <div class=\"bg-white text-xl\">\n        <div class=\"mx-auto px-4\">\n          <div class=\"flex justify-between items-center py-6\">\n            <div class=\"flex justify-start\">\n              <h1 class=\"font-extrabold\">Hacker News</h1>\n            </div>\n            <div class=\"item-center justify-end\">\n              <a href=\"#/page/{{__current_page__}}\" class=\"text-gray-500\">\n                <i class=\"fa fa-times\"></i>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"h-full border rounded-xl bg-white m-6 p-4\">\n        <h2>{{__title__}}</h2>\n        <div class=\"text-gray-400 h-20\">\n          {{__content__}}\n        </div>\n\n        {{__comments__}}\n\n      </div>\n    </div>\n  `;\n\n    super(containerId, template);\n\n    this.api = new NewsDetailApi();\n    this.store = store;\n  }\n\n  // Promise 객체를 반환하지 않지만 async 함수 이기 떄문에 \n  // return을 Promise로 감싸줘야 한다.\n  async render(): Promise<void> {\n    const id = location.hash.substring(7);\n    const {title, content, comments} = await this.api.getData(id);\n    \n    this.store.makeRead(Number(id));\n    this.setTemplatedata(\"comments\", this.makeComment(comments));\n    this.setTemplatedata(\"current_page\", String(this.store.currentPage));\n    this.setTemplatedata(\"title\", title);\n    this.setTemplatedata(\"content\", content);\n\n    this.updateView();\n  }\n\n  private makeComment(comments: NewsComment[]): string {\n    for (let i = 0; i < comments.length; i++) {\n      const comment: NewsComment = comments[i];\n      this.addHtml(`\n        <div style=\"padding-left: ${comment.level * 40}px;\" class=\"mt-4\">\n           <div class=\"text-gray-400\">\n            <i class=\"fa fa-sort-up mr-2\"></i>\n            <strong>${comment.user}</strong> ${comment.time_ago}\n          </div>\n          <p class=\"text-gray-700\">${comment.content}</p>\n        </div>\n      `);\n\n      if (comment.comments.length > 0) {\n        this.addHtml(this.makeComment(comment.comments));\n      }\n    }\n\n    return this.getHtml();\n  }\n}\n"],"names":["$61f4b5e1c3ca4d0f$export$2e2bcd8739ae039","constructor","containerId","template","containerElement","document","getElementById","this","container","renderTemplate","htmlList","updateView","innerHTML","addHtml","htmlString","push","getHtml","snapshot","join","clearHtmlList","setTemplatedata","key","value","replace","$a389c5416fb017a9$export$bf71da7aebe9ddc1","async","url","response","fetch","json","$a389c5416fb017a9$export$a68bda1f47baccec","request","$a389c5416fb017a9$export$41fdb0f2b3130c97","id","$a389c5416fb017a9$var$applyApiMixins","targetClass","baseClass","forEach","Object","getOwnPropertyNames","prototype","name","descriptor","getOwnPropertyDescriptor","defineProperty","printHello","console","log","$f43313d21d3fd8e2$var$store","feeds","_currentPage","currentPage","page","nextPage","prevPage","numberOfFeed","length","hasFeeds","getAllFeeds","getFeed","position","setFeeds","map","feed","read","makeRead","find","$f43313d21d3fd8e2$var$router","location","hash","split","window","addEventListener","route","bind","routeTable","defaultRoute","setDefaultPage","path","addRoutePath","routePath","render","routeInfo","indexOf","$f43313d21d3fd8e2$var$newsFeedView","store","super","api","totalPages","pageSize","Number","substring","getData","Math","floor","i","title","comments_count","user","points","time_ago","$f43313d21d3fd8e2$var$newsDetailView","content","comments","makeComment","String","comment","level"],"version":3,"file":"index.de67429b.js.map"}